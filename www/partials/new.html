<ion-view title="{{ 'UBOULDER' | translate }}">
  <ion-nav-buttons side="left">
    <button menu-toggle="left"class="button button-icon icon ion-navicon"></button>
  </ion-nav-buttons>
  <ion-content class="has-header">

    <div class="alert alert-danger text-center" id="offline" onclick="location.reload();">
        <i class="ion-alert-circled"></i> <strong>{{ 'OFFLINE_TAP' | translate }}</strong>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <h1><a ng-back></a> {{'NEW_NEWSPOT' | translate}}</h1>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <legend>{{'NEW_BASIC_INFO' | translate}}<small>{{'NEW_INFO_TEXT' | translate}}</small></legend>
      </div>
    </div>

    <form name="spotForm">

    <div class="row">
      <div class="col-xs-20">
        <div class="form-group">
          <input type="text" class="disable form-control" maxlength="50" placeholder="{{ 'NEW_TITLE' | translate }} *" ng-model="vm.spot.title" required ng-disabled="vm.edit">
        </div>

        <div class="form-group">
          <textarea ng-model="vm.spot.description" rows="6" class="form-control" maxlength="500" placeholder="{{ 'NEW_DESCRIPTION' | translate }} *" ngMinlength="5" ngMaxlength="500" required ng-disabled="vm.edit"></textarea>
        </div>
          <p class="pull-right" ng-if="!vm.edit">
            <span ng:bind="500 - vm.spot.description.length"></span> {{'NEW_CHAR' | translate}}
          </p>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <legend>{{'NEW_PICTURE' | translate}}</legend>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <p>
          <span class="label label-warning">{{'NEW_IMPORTANT' | translate}}</span> {{'NEW_FILE_SIZE' | translate}}
        </p>
      </div>
    </div>

    <div ng-repeat="picture in vm.media" class="row form-group">
      <div ng-if="(picture.url == null)">
        <img-upload></img-upload>
      </div>
      <div ng-if="(picture.url != null)" class="col-xs-20">
        <img ng-src="{{picture.url}}/128/128/crop" alt="vm.spot.title">
      </div>
      <div class="col-xs-10">
        <button type="button" class="btn btn-warning" ng-click="vm.deleteMedia($index)"><i class="ion-minus-circled"></i> {{'NEW_REMOVE' | translate}}</button>                  
      </div>
    </div>
    <div class="row form-group">
      <div class="col-xs-12">
        <button class="btn" ng-click="vm.addMedia()"><i class="ion-plus-circled"></i> {{'NEW_ADD_PICTURE' | translate}}</button>
      </div>
    </div>

    <div class="row" ng-if="!vm.edit">
      <div class="col-sm-20">
        <legend>{{'NEW_LOCATION' | translate}}</legend>
      </div>
    </div>

    <!-- ng-if is throwing an error, so i have to render this div -->
    <div class="row" ng-show="!vm.edit">
      <div class="col-sm-20">
        <div id="map" style="height:250px"></div>
      </div>
    </div>



    <div class="row pPricing">
      <div class="col-sm-20">
        <legend>{{'PRICING' | translate}}<small>{{'PRICING_INFO' | translate}}</small></legend>
      </div>
    </div>

    <div class="row form-group" ng-repeat="pricing in vm.pricing">
      <div class="col-xs-10">
        <input type="text" class="form-control form-group" maxlength="50" placeholder="{{ 'NEW_PRODUCT_NAME' | translate }}" ng-model="pricing.description" required>
      </div>
      <div class="col-xs-10">
        <div class="form-group">
          <div class="input-group">
            <div class="input-group-addon">â‚¬</div>
            <input class="form-control" type="number" step="any" placeholder="{{ 'PRICE' | translate}}" maxlength="10" ng-model="pricing.amount" required>
          </div>
        </div>
      </div>
      <div class="col-xs-12">
        <button type="button" class="btn btn-warning" ng-click="vm.deletePricing($index)"><i class="ion-minus-circled"></i> {{'NEW_REMOVE' | translate}}</button>
      </div>
    </div>

    <div class="row form-group">
      <div class="col-xs-10">
        <button class="btn" ng-click="vm.addPricing()"><i class="ion-plus-circled"></i> {{'NEW_ADD_PRODUCT' | translate}}</button>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <legend>{{'INFRASTRUCTURE' | translate }}</legend>
      </div>
    </div>

    <div class="row">
      <div class="form-group">
        <div class="col-xs-10 inf" ng-repeat="infrastructure in vm.infrastructure">
          <label class="checkbox-inline">
            <input type="checkbox" value="infrastructure" ng-checked="vm.spot.infrastructure.indexOf(infrastructure) > -1" ng-click="vm.toggleInfrastructure(infrastructure)"> {{ infrastructure | translate }}
          </label>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <hr>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-20">
        <button class="btn btn-success pull-right btn-lg" ng-click="vm.showSummary()"><i class="ion-refreshing" ng-show="vm.loading"></i> <b>{{'NEW_SAVE' | translate}}  </b><i class="ion-chevron-right"></i></button>
      </div>
    </div>

    </form>

  </ion-content>
</ion-view>